(this["webpackJsonpwordgame-app"]=this["webpackJsonpwordgame-app"]||[]).push([[0],{196:function(e,t,r){"use strict";r.r(t);var n=r(10),a=r(0),c=r.n(a),s=r(18),o=r.n(s),u=(r(88),r(89),r(16)),l=r(23),i=(r(90),r(5)),m=r.n(i),p=r(7),b=c.a.createContext(),d=c.a.createContext(),f=r(39),g=r.n(f),h="http://hallodeutsch.fatmandesigner.com",x=function(){var e=Object(p.a)(m.a.mark((function e(t,r){var n,a,c=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>2&&void 0!==c[2]?c[2]:null,localStorage.getItem("".concat("wg",":token")),a={"Content-Type":"application/json"},e.abrupt("return",fetch(t,"GET"===r||"DELETE"===r?{headers:a,method:r}:{headers:a,method:r,body:n}).catch((function(e){return{ok:!1,error:e}})));case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),v=function(){var e=Object(p.a)(m.a.mark((function e(t){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",{ok:!1});case 2:if(e.prev=2,!(r=t.headers.get("content-type"))||!r.match(/json/)){e.next=13;break}if(!(t.status>=400)){e.next=10;break}return e.next=8,t.json();case 8:return e.t0=e.sent,e.abrupt("return",{ok:!1,error:e.t0});case 10:return e.abrupt("return",t.json());case 13:return e.next=15,t.text();case 15:return e.t1=e.sent,e.abrupt("return",{ok:!1,error:e.t1});case 17:e.next=22;break;case 19:return e.prev=19,e.t2=e.catch(2),e.abrupt("return",{ok:!1,error:e.t2});case 22:case"end":return e.stop()}}),e,null,[[2,19]])})));return function(t){return e.apply(this,arguments)}}(),E={request:x,get:function(e){return Object(p.a)(m.a.mark((function t(){var r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x("".concat(h).concat(e),"GET");case 2:return r=t.sent,t.abrupt("return",v(r));case 4:case"end":return t.stop()}}),t)})))()},post:function(e,t){return Object(p.a)(m.a.mark((function r(){var n;return m.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,x("".concat(h).concat(e),"POST",JSON.stringify(t));case 2:return n=r.sent,r.abrupt("return",v(n));case 4:case"end":return r.stop()}}),r)})))()},put:function(e,t){return Object(p.a)(m.a.mark((function r(){var n;return m.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,x("".concat(h).concat(e),"PUT",JSON.stringify(t));case 2:return n=r.sent,r.abrupt("return",v(n));case 4:case"end":return r.stop()}}),r)})))()},patch:function(e,t){return Object(p.a)(m.a.mark((function r(){var n;return m.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,x("".concat(h).concat(e),"PATCH",JSON.stringify(t));case 2:return n=r.sent,r.abrupt("return",v(n));case 4:case"end":return r.stop()}}),r)})))()},delete:function(e){return Object(p.a)(m.a.mark((function t(){var r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x("".concat(h).concat(e),"DELETE");case 2:return r=t.sent,t.abrupt("return",v(r));case 4:case"end":return t.stop()}}),t)})))()}},k=E,w=r(215),O=r(197),j=r(198),y=r(199),N=function(){return c.a.createElement(w.a,{isOpen:!0,contentClassName:"bg-transparent border-0"},c.a.createElement(O.a,null,c.a.createElement("div",{className:"loader"},"Loading...")))},C=r(12),I=r(82),S=null,_=function(){var e=Object(p.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(I.a)("WordGame",4,{upgrade:function(e){e.createObjectStore("sessions",{keyPath:"id"}),e.createObjectStore("terms",{keyPath:"id"}).createIndex("index","index")}});case 2:S=e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(p.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S){e.next=2;break}return e.abrupt("return",S);case 2:return e.next=4,_();case 4:return e.abrupt("return",S);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(p.a)(m.a.mark((function e(){var t,r,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:return t=e.sent,e.next=5,t.transaction("terms","read").store.openCursor();case 5:r=e.sent,n=[];case 7:if(!r){e.next=14;break}return n.push(r.value),e.next=11,r.continue();case 11:r=e.sent,e.next=7;break;case 14:return e.abrupt("return",R(n));case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(p.a)(m.a.mark((function e(t){var r,n,a,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:return r=e.sent,n=r.transaction("sessions","readwrite"),a=Date.now().toString(),e.next=7,Promise.all([n.store.add({id:a,corrects:0,wrongs:0,count:t.length,nextWordIndex:0}),n.done]);case 7:return c=r.transaction("terms","readwrite"),e.next=10,c.store.clear();case 10:return e.next=12,Promise.all(t.sort((function(){return Math.random()-.5})).map((function(e,t){return c.store.add(Object(C.a)({},e,{index:t}))})));case 12:return e.next=14,c.done;case 14:return e.abrupt("return",a);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(p.a)(m.a.mark((function e(t){var r,n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:return r=e.sent,n=r.transaction("sessions").objectStore("sessions"),e.next=6,n.get(t);case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(p.a)(m.a.mark((function e(t){var r,n,a,c,s,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:return r=e.sent,n=r.transaction("sessions","readwrite").objectStore("sessions"),e.next=6,n.get(t);case 6:if(a=e.sent,c=a.nextWordIndex,s=a.count,-1!==c){e.next=10;break}return e.abrupt("return",null);case 10:return e.next=12,n.put(Object(C.a)({},a,{nextWordIndex:c+1<s?c+1:-1}));case 12:return e.next=14,r.getFromIndex("terms","index",c);case 14:return o=e.sent,e.abrupt("return",{term:o,hasNext:c+1<s});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(p.a)(m.a.mark((function e(t,r){var n,a,c,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:return n=e.sent,a=n.transaction("sessions","readwrite"),c=a.objectStore("sessions"),e.next=7,c.get(t);case 7:return s=e.sent,e.next=10,c.put(Object(C.a)({},s,{corrects:s.corrects+r.correct,wrongs:s.wrongs+!r.correct,stats:(s.stats||[]).concat(r)}));case 10:return e.next=12,a.done;case 12:return e.abrupt("return",{ok:!0});case 13:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),B=function(){var e=Object(p.a)(m.a.mark((function e(t){var r,n,a,c,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.next=3,A();case 3:return n=e.sent,e.next=6,n.transaction("terms").store.openCursor();case 6:a=e.sent;case 7:if(!a){e.next=14;break}return r.push(a.value),e.next=11,a.continue();case 11:a=e.sent,e.next=7;break;case 14:return e.next=16,n.get("sessions",t);case 16:return c=e.sent,s=(c.stats||[]).reduce((function(e,t){var n=r.find((function(e){return e.word===t.termId})),a=n.tags.includes("MAS")?"der":n.tags.includes("FEM")?"die":n.tags.includes("NEU")?"das":null;return a?(t.correct?e[a].corrects+=1:e[a].wrongs+=1,e):e}),{der:{corrects:0,wrongs:0},die:{corrects:0,wrongs:0},das:{corrects:0,wrongs:0}}),e.abrupt("return",s);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(e){var t=e.sessionId,r=Object(a.useContext)(b),s=Object(a.useContext)(d),o=Object(l.g)(),u=Object(a.useState)({busy:!1,error:null}),i=Object(n.a)(u,2),f=i[0],g=i[1],h=Object(a.useState)(null),x=Object(n.a)(h,2),v=x[0],E=x[1],k=Object(a.useState)(null),C=Object(n.a)(k,2),I=C[0],S=C[1],_=Object(a.useCallback)(Object(p.a)(m.a.mark((function e(){var n,a,c,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r({type:"user/next-term",status:"pending"}),e.next=3,L(t);case 3:if(n=e.sent,a=n.term,c=n.hasNext,s=n.error,a){e.next=14;break}if(401!==s.status_code){e.next=12;break}return localStorage.clear(),o.replace("/login",{expired:!0}),e.abrupt("return");case 12:return r({type:"user/next-term",status:"error",error:s}),e.abrupt("return");case 14:r({type:"user/next-term",status:"ok",term:a,hasNext:c}),S(Date.now()/1e3);case 16:case"end":return e.stop()}}),e)}))),[r,s,t]),A=Object(a.useCallback)(function(){var e=Object(p.a)(m.a.mark((function e(r){var n,a,c,u,l,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.getIn(["gameSession","term","id"]),a=s.getIn(["gameSession","term","tags"]),c=a.includes(r),e.next=5,M(t,{termId:n,correct:c,seconds:Date.now()/1e3-I});case 5:if(u=e.sent,l=u.ok,i=u.error,l){e.next=14;break}if(401!==i.status_code){e.next=13;break}return localStorage.clear(),o.replace("/login",{expired:!0}),e.abrupt("return");case 13:return e.abrupt("return");case 14:if(c){e.next=18;break}E({correct:c,article:a.includes("MAS")?"der":a.includes("FEM")?"die":"das"}),e.next=24;break;case 18:if(!s.getIn(["gameSession","hasNext"])){e.next=23;break}return e.next=21,_();case 21:e.next=24;break;case 23:P();case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[r,I,s.getIn(["gameSession","term"])]),P=Object(a.useCallback)(Object(p.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g({busy:!0}),t=s.getIn(["gameSession","id"]),r({type:"user/show-report",status:"pending",sessionId:t}),e.next=5,B(t);case 5:n=e.sent,r({type:"user/show-report",status:"ok",report:{session:n}});case 7:case"end":return e.stop()}}),e)}))),[r,s.getIn(["gameSession","term"])]),R=Object(a.useCallback)(Object(p.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:case"end":return e.stop()}}),e)}))),[r,s.getIn(["gameSession","term"])]),T=Object(a.useCallback)(Object(p.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E(null),!s.getIn(["gameSession","hasNext"])){e.next=6;break}return e.next=4,_();case 4:e.next=7;break;case 6:P();case 7:case"end":return e.stop()}}),e)}))),[r,s.getIn(["gameSession","term"]),s.getIn(["gameSession","hasNext"])]);Object(a.useEffect)((function(){Object(p.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:case"end":return e.stop()}}),e)})))()}),[]);var D=s.getIn(["gameSession","term"]);return c.a.createElement("section",{className:"row"},c.a.createElement("div",{className:"col"},c.a.createElement("h2",{className:"text-center text-black-50"},"Play"),!D&&c.a.createElement("p",{className:"text-center"},"Loading..."),!!D&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"term mt-5 mb-5"},c.a.createElement("div",{className:"text-center display-2 text-break"},D.get("word")),c.a.createElement("button",{className:"btn btn-sm btn-link"},"Meaning >>")),c.a.createElement("div",{className:"actions text-center"},c.a.createElement("div",{className:"btn-group w-75"},c.a.createElement("button",{className:"btn btn-light btn-lg text-white btn-circle bg-masculine",onClick:function(){return A("MAS")}},"Der"),c.a.createElement("button",{className:"btn btn-light btn-lg text-white btn-circle bg-feminine",onClick:function(){return A("FEM")}},"Die"),c.a.createElement("button",{className:"btn btn-light btn-lg text-white btn-circle bg-neuter",onClick:function(){return A("NEU")}},"Das")),c.a.createElement("div",{className:"btn-group w-100 mt-5"},c.a.createElement("button",{className:"btn btn-primary btn-sm",onClick:R},"Skip")),c.a.createElement("div",{className:"text-center mt-5"},c.a.createElement("button",{className:"btn btn-light",onClick:P},"I'm done for now"))))),!!v&&c.a.createElement(w.a,{isOpen:!0},c.a.createElement(O.a,null,c.a.createElement("div",{className:"display-2 text-center",style:{wordBreak:"break-word"}},c.a.createElement("span",{className:"font-weight-lighter text-muted"},D.get("word")),", ",c.a.createElement("br",null),c.a.createElement("span",{className:"font-weight-bold"},v.article))),c.a.createElement(j.a,null,c.a.createElement(y.a,{color:"success",onClick:T,className:"mx-auto"},"Next"))),!!f.busy&&c.a.createElement(N,null))},F=r(40),W={fill:!1,lineTension:.1,backgroundColor:"rgba(63,69,192,0.4)",borderColor:"rgb(65,121,192)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10},U=function(e){var t=e.weeklyPerformance,r=t.map((function(e){var t,r=e.week;return t=new Date(7*r*86400*1e3),"".concat(t.getMonth()+1,".").concat(t.getDate())})),n=t.map((function(e){return(100*e.confidence_factor).toFixed(2)})),a=t.map((function(e){return(100*e.correct_factor).toFixed(2)}));return c.a.createElement(F.b,{data:{labels:r,datasets:[Object(C.a)({label:"Correct",data:a},W),Object(C.a)({label:"Confidence",data:n},W,{backgroundColor:"#C0122A",borderColor:"#f3132c"})]},width:100,height:40,options:{scales:{yAxes:[{ticks:{max:100,min:0,stepSize:20}}]},maintainAspectRatio:!0,layout:{padding:0}}})},J=function(){var e=Object(a.useContext)(d),t=e.getIn(["report","session"]),r=e.getIn(["report","weekly_performance"]),n=t.getIn(["der","corrects"])/(t.getIn(["der","corrects"])+t.getIn(["der","wrongs"])),s=t.getIn(["die","corrects"])/(t.getIn(["die","corrects"])+t.getIn(["die","wrongs"])),o=t.getIn(["das","corrects"])/(t.getIn(["das","corrects"])+t.getIn(["das","wrongs"]));return c.a.createElement("section",{className:"row"},c.a.createElement("div",{className:"col"},c.a.createElement("h2",null,"Report"),c.a.createElement("div",{className:"card"},c.a.createElement("div",{className:"card-header"},c.a.createElement("h3",null,"Session Report")),c.a.createElement("div",{className:"card-body"},c.a.createElement("div",{className:"progress-group"},c.a.createElement("div",{className:"progress-label"},"DER"),c.a.createElement("div",{className:"progress mr-0"},c.a.createElement("div",{className:"progress-bar bg-masculine",role:"progressbar",style:{width:"".concat(100*n,"%")}}))),c.a.createElement("div",{className:"progress-group"},c.a.createElement("div",{className:"progress-label"},"DIE"),c.a.createElement("div",{className:"progress mr-0"},c.a.createElement("div",{className:"progress-bar bg-feminine",role:"progressbar",style:{width:"".concat(100*s,"%")}}))),c.a.createElement("div",{className:"progress-group"},c.a.createElement("div",{className:"progress-label"},"DAS"),c.a.createElement("div",{className:"progress mr-0"},c.a.createElement("div",{className:"progress-bar bg-neuter",role:"progressbar",style:{width:"".concat(100*o,"%")}}))))),!!r&&c.a.createElement("div",{className:"card mt-4"},c.a.createElement("div",{className:"card-header"},c.a.createElement("h3",{className:"mb-0"},"Weekly Report")),c.a.createElement("div",{className:"card-body"},c.a.createElement(U,{weeklyPerformance:r.toJS()})))))},q=r(26),G=r.n(q),H=r(41),z=function(e){var t=Object(a.useContext)(b),r=Object(a.useContext)(d),s=Object(a.useState)(null),o=Object(n.a)(s,2),i=o[0],f=o[1],g=Object(l.g)(),h=Object(l.i)(),x=Object(a.useCallback)(Object(p.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P();case 2:t=e.sent,g.replace("/play/".concat(t));case 4:case"end":return e.stop()}}),e)}))),[i]);Object(a.useEffect)((function(){Object(p.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(H.load)("6LfUb-EUAAAAAEBdxIpMqGCi2e7ScZ4I4eqVhzAh");case 2:t=e.sent,f(t);case 4:case"end":return e.stop()}}),e)})))()})),Object(a.useEffect)((function(){Object(p.a)(m.a.mark((function e(){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h.sessionId){e.next=7;break}return e.next=3,T(h.sessionId);case 3:r=e.sent,t({type:"user/start-session",status:"ok",session:r}),e.next=8;break;case 7:localStorage.getItem("wg:token")?g.replace("/collections"):g.replace("/login");case 8:case"end":return e.stop()}}),e)})))()}),[t,h.sessionId]);var v=Object(a.useCallback)(function(){var e=Object(p.a)(m.a.mark((function e(r){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r.accessToken,a=r.profileObj,localStorage.setItem("wg:profileObj",a),localStorage.setItem("wg:token",n),t({type:"user/login",status:"ok",token:n,profile:a}),g.replace("/collections");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t,g]),E=r.getIn(["gameSession"]);return c.a.createElement("div",{className:"container play-page"},!(E&&E.get("id"))&&c.a.createElement("section",{className:"row"},c.a.createElement("div",{className:"col"},c.a.createElement("div",{className:"btn btn-primary btn-lg w-100",style:{marginTop:"75%"}},"START"))),!(!E||!E.get("id")||"playing"!==E.get("status"))&&c.a.createElement(D,{sessionId:E.get("id")}),!(!E||!E.get("id")||"done"!==E.get("status"))&&c.a.createElement(J,{sessionId:E.get("id")}),!(!E||!E.get("id")||"done"!==E.get("status"))&&c.a.createElement("section",{className:"row"},c.a.createElement("div",{className:"col"},r.getIn(["profile","isLoggedIn"])&&c.a.createElement(u.b,{className:"btn btn-sm btn-link btn-block",to:"/collections"},"Back to collections"),!r.getIn(["profile","isLoggedIn"])&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"row mt-2 justify-content-center"},c.a.createElement("div",{className:"col-6"},c.a.createElement(y.a,{disabled:!i,color:"primary",block:!0,onClick:x},"TRY AGAIN!"))),c.a.createElement(G.a,{clientId:"976856176051-ietkcknpua13udt2tucm8sbecik7h5rt.apps.googleusercontent.com",onSuccess:v,responseType:"code",className:"mt-5"}),c.a.createElement("p",{className:"text-muted"},"...to keep track of your progress")))))},Y=r(200),V=function(){var e=Object(a.useState)(null),t=Object(n.a)(e,2),r=t[0],s=t[1],o=Object(a.useContext)(b),u=Object(l.g)(),i=Object(l.i)(),d=Object(l.h)(),f=Object(a.useCallback)(function(){var e=Object(p.a)(m.a.mark((function e(t){var r,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.accessToken,n=t.profileObj,localStorage.setItem("wg:profile",JSON.stringify(n)),localStorage.setItem("wg:token",r),o({type:"user/login",status:"ok",token:r}),u.replace("/collections");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o,u]),g=Object(a.useCallback)(Object(p.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R([]);case 2:t=e.sent,u.replace("/play/".concat(t));case 4:case"end":return e.stop()}}),e)}))),[r]);return Object(a.useEffect)((function(){console.log(i),Object(p.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(H.load)("6LfUb-EUAAAAAEBdxIpMqGCi2e7ScZ4I4eqVhzAh");case 2:t=e.sent,s(t);case 4:case"end":return e.stop()}}),e)})))()})),c.a.createElement("div",{className:"container login-page"},!(!d.state||!d.state.expired)&&c.a.createElement(Y.a,{className:"mt-2 alert-float",isOpen:!0,color:"warning",toggle:function(){return u.replace("/login")}},c.a.createElement("h4",{className:"alert-heading"},"Your session has expired."),c.a.createElement("p",{className:"mt-3 text-center text-sm-left"},"Without logging in, your session lasts for only for 10 minutes.")),c.a.createElement("section",{className:"row"},c.a.createElement("div",{className:"col"},c.a.createElement("h3",{style:{marginTop:"50%"}},"Hallo Deutsch"),c.a.createElement(G.a,{clientId:"976856176051-ietkcknpua13udt2tucm8sbecik7h5rt.apps.googleusercontent.com",onSuccess:f,responseType:"token",isSignedIn:!0}),c.a.createElement("p",{className:"text-muted"},"...to coup with the insane irregularity in the German language."))),c.a.createElement("div",{className:"row justify-content-center"},c.a.createElement("div",{className:"col-6"},c.a.createElement(y.a,{disabled:!r,color:"primary",block:!0,onClick:g},"TRY NOW!"))))},Z=r(201),$=r(202),K=r(203),Q=r(204),X=r(205);function ee(e,t){return te.apply(this,arguments)}function te(){return(te=Object(p.a)(m.a.mark((function e(t,r){var n,a,c,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.request(t,"GET");case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("Bad Request");case 5:return e.next=7,n.json();case 7:if("base64"===(a=e.sent).encoding){e.next=10;break}throw new Error("Bad Request");case 10:return c=decodeURIComponent(escape(atob(a.content))),s=r(c),e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re=function(){var e=Object(p.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://api.github.com/repos/khanhhua/wordgame-data/contents/menschen/package.json",e.prev=1,e.next=4,ee("https://api.github.com/repos/khanhhua/wordgame-data/contents/menschen/package.json",JSON.parse);case 4:return t=e.sent,e.abrupt("return",t.collections);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=Object(p.a)(m.a.mark((function e(t){var r,n,a,c,s=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.file,n=s.length>1&&void 0!==s[1]?s[1]:null,a="https://api.github.com/repos/khanhhua/wordgame-data/contents/menschen/".concat(r),e.prev=3,e.next=6,ee(a,(function(e){return e.split("\n").filter(Boolean).map((function(e){var t=e.split(";");return{id:t[0],word:t[0],meaning:t[1],tags:t[2]}})).filter((function(e){switch(n){default:return!0;case"noun":var t=e.tags;return t.includes("MAS")||t.includes("FEM")||t.includes("NEU")}}))}));case 6:return c=e.sent,console.log({words:c}),e.abrupt("return",c);case 11:return e.prev=11,e.t0=e.catch(3),e.abrupt("return",[]);case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}(),ae=function(e){var t=e.collections,r=e.onReviewClick,n=e.onEditClick,a="function"===typeof n;return c.a.createElement("div",{className:"list-group list-group-flush"},t.map((function(e){return c.a.createElement("div",{key:e.get("id"),className:"list-group-item px-1"},e.get("name"),c.a.createElement("div",{className:"actions float-right"},c.a.createElement("div",{className:"btn-group btn-group-sm"},a&&c.a.createElement("button",{className:"btn btn-sm btn-light",onClick:function(){return n(e)}},"Edit"),c.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:function(){return r(e)}},"Review"))))})))},ce=function(e){var t=Object(a.useContext)(b),r=Object(a.useContext)(d),s=Object(a.useState)({visible:!1,name:""}),o=Object(n.a)(s,2),u=o[0],i=o[1],f=Object(a.useRef)(),g=Object(l.g)();Object(a.useEffect)((function(){Object(p.a)(m.a.mark((function e(){var r,n,a,c,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re().then((function(e){return{collections:e,myCollections:[],ok:!0,error:null}}));case 2:if(r=e.sent,n=r.ok,a=r.collections,c=r.myCollections,s=r.error,n){e.next=14;break}if(401!==s.status_code){e.next=12;break}return localStorage.clear(),g.replace("/login",{expired:!0}),e.abrupt("return");case 12:return t({type:"user/list-collections",status:"error",error:s}),e.abrupt("return");case 14:t({type:"user/list-collections",status:"ok",collections:a,myCollections:c});case 15:case"end":return e.stop()}}),e)})))()}),[t]);var h=function(){var e=Object(p.a)(m.a.mark((function e(r){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"user/start-session",status:"pending"}),e.next=3,ne({file:r.get("file")},"noun");case 3:return n=e.sent,e.next=6,R(n);case 6:a=e.sent,g.push("/play/".concat(a));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=Object(a.useCallback)(Object(p.a)(m.a.mark((function e(){var r,n,a,c,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:r="user/create-collection",status:"pending"}),e.next=4,k.post("/api/me/collections",{name:f.current.value});case 4:if(n=e.sent,a=n.ok,c=n.collection,s=n.error,a){e.next=14;break}if(401!==s.status_code){e.next=13;break}return localStorage.clear(),g.replace("/login",{expired:!0}),e.abrupt("return");case 13:return e.abrupt("return",t({type:r,status:"error",error:s}));case 14:t({type:r,status:"ok",collection:c}),i({visible:!1});case 16:case"end":return e.stop()}}),e)}))),[t,f]),v=Object(a.useCallback)(function(){var e=Object(p.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g.push("/collections/".concat(t.get("id")));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[g]),E=r.get("collections"),N=r.get("myCollections");return c.a.createElement("div",{className:"container my-collection-list-page"},c.a.createElement("section",{className:"row"},c.a.createElement("div",{className:"col"},!(!N||!N.size)&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"w-100"},c.a.createElement("button",{onClick:function(){return i({visible:!0})},className:"btn btn-sm btn-light mt-2 float-right"},"Add"),c.a.createElement("h2",null,"My Learning List")),c.a.createElement(ae,{onEditClick:v,collections:N,onReviewClick:h})),!(E&&E.size)&&c.a.createElement("p",{className:"text-center"},"Loading..."),!(!E||!E.size)&&c.a.createElement(c.a.Fragment,null,c.a.createElement("h2",{className:"mt-5"},"Collections"),c.a.createElement(ae,{collections:E,onReviewClick:h})))),!!u.visible&&c.a.createElement(w.a,{isOpen:u.visible},c.a.createElement(Z.a,{toggle:function(){return i({visible:!1})}},"New Collection"),c.a.createElement(O.a,null,c.a.createElement($.a,null,c.a.createElement(K.a,null,c.a.createElement(Q.a,null,"Name"),c.a.createElement(X.a,{innerRef:f})))),c.a.createElement(j.a,null,c.a.createElement(y.a,{onClick:x,color:"primary"},"Create"))))},se=r(206),oe=r(207),ue=r(208),le=r(209),ie={backgroundColor:"rgba(63,69,192,0.4)",borderColor:"rgb(65,121,192)",borderWidth:1,hoverBackgroundColor:"rgba(63,69,192,0.4)",hoverBorderColor:"rgb(65,121,192)"},me=function(e){var t=e.histogram;return c.a.createElement(F.a,{width:100,height:50,data:{labels:t.map((function(e){return e.seconds})),datasets:[Object(C.a)({label:"Correct Response Time (s)",data:t.map((function(e){return e.correct_count}))},ie),Object(C.a)({label:"Incorrect Response Time (s)",data:t.map((function(e){return e.wrong_count}))},ie,{backgroundColor:"rgba(192,83,102,0.4)",borderColor:"rgb(192,73,90)"})]},options:{scales:{yAxes:[{ticks:{min:0}}],xAxes:[{distribution:"series"}]}}})},pe=function(){var e=Object(p.a)(m.a.mark((function e(t){var r,a,c,s,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.weekly,t.worst,t.histogram,r=[],e.next=4,A();case 4:return a=e.sent,e.next=7,a.transaction("sessions").store.openCursor();case 7:c=e.sent;case 8:if(!c){e.next=15;break}return c.value.stats&&(r=r.concat(c.value.stats)),e.next=12,c.continue();case 12:c=e.sent,e.next=8;break;case 15:return s=Object.entries(r.reduce((function(e,t){var r=t.termId,n=t.correct,a=t.seconds,c=r;c in e||(e[c]={correct_count:0,seconds_correct:0,total_count:0,total_seconds:0});var s=e[c];return n&&(s.correct_count+=1,s.seconds_correct+=a),s.total_count+=1,s.total_seconds+=a,e}),{})).map((function(e){var t=Object(n.a)(e,2),r=t[0],a=t[1],c=a.correct_count,s=a.total_count,o=a.seconds_correct,u=a.total_seconds;return{word:r,correct_factor:Math.round(100*c/(1*s))/100,confidence_factor:Math.round(100*o/(1*u))/100}})).sort((function(e,t){return e.correct_factor-t.correct_factor})).slice(0,20),o=Object.entries(r.reduce((function(e,t){var r=t.correct,n=t.seconds,a=Math.floor(n);a in e||(e[a]={correct_count:0,wrong_count:0});var c=e[a];return r?c.correct_count+=1:c.wrong_count+=1,e}),{})).map((function(e){var t=Object(n.a)(e,2),r=t[0],a=t[1];return Object(C.a)({seconds:r},a)})).sort((function(e,t){return e.seconds-t.seconds})),e.abrupt("return",{worstPerformers:s,weeklyPerformance:[],histogram:o});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),be={MAS:"bg-masculine",FEM:"bg-feminine",NEU:"bg-neuter"},de=function(e){var t=/MAS|FEM|NEU/.exec(e);return t?be[t[0]]:""},fe=function(e){var t=Object(a.useState)({busy:!1,error:null}),r=Object(n.a)(t,2),s=r[0],o=r[1],u=Object(a.useState)({worstPerformers:[],weeklyPerformance:[],histogram:[]}),l=Object(n.a)(u,2),i=l[0],b=l[1];return Object(a.useEffect)((function(){Object(p.a)(m.a.mark((function e(){var t,r,n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o({busy:!0}),e.next=3,pe({});case 3:t=e.sent,r=t.worstPerformers,n=t.weeklyPerformance,a=t.histogram,o({busy:!1}),b({worstPerformers:r,weeklyPerformance:n,histogram:a});case 9:case"end":return e.stop()}}),e)})))()}),[]),c.a.createElement("div",{className:"container report-page"},!!s.busy&&c.a.createElement(N,null),c.a.createElement("section",{className:"row"},c.a.createElement("div",{className:"col"},c.a.createElement("h2",null,"Report"),c.a.createElement(se.a,null,c.a.createElement(oe.a,null,c.a.createElement("h5",{className:"mb-0"},"Needs improvements")),c.a.createElement(ue.a,null,i.worstPerformers.map((function(e){return c.a.createElement(le.a,{pill:!0,className:"p-2 mr-2 mb-2 ".concat(de(e.tags)),style:{opacity:1.05-e.confidence_factor}},e.word,c.a.createElement("span",{className:"pl-2"},100*e.correct_factor,"%"))})))),c.a.createElement(se.a,{className:"mt-2"},c.a.createElement(oe.a,null,c.a.createElement("h5",{className:"mb-0"},"Performance")),c.a.createElement(ue.a,null,!!(i&&i.histogram&&i.histogram.length)&&c.a.createElement(me,{histogram:i.histogram}),!!(i&&i.weeklyPerformance&&i.weeklyPerformance.length)&&c.a.createElement(U,{weeklyPerformance:i.weeklyPerformance}))))))},ge=r(210),he=r(211),xe=r(212),ve=function(){var e=Object(a.useContext)(b),t=Object(a.useContext)(d),r=Object(a.useCallback)((function(){e({type:"user/logout"}),window.localStorage.clear()}),[]);return c.a.createElement(ge.a,{light:!0,className:"bg-light"},c.a.createElement(he.a,{className:"font-weight-lighter"},"Hallo Deutsch"),!!t.getIn(["profile","isLoggedIn"])&&[c.a.createElement(xe.a,{className:"mx-auto"},c.a.createElement(u.c,{to:"/collections",exact:!0,className:"nav-item px-2"},"Collections"),c.a.createElement(u.c,{to:"/report",exact:!0,className:"nav-item px-2"},"Report")),c.a.createElement(xe.a,null,c.a.createElement(q.GoogleLogout,{clientId:"976856176051-ietkcknpua13udt2tucm8sbecik7h5rt.apps.googleusercontent.com",buttonText:"Logout",onLogoutSuccess:r}))])},Ee=r(31),ke=r(213),we=r(214),Oe=r(81),je=function(e){var t={};return Object.keys(E).forEach((function(r){Object.defineProperty(t,r,{value:g()(E[r],1e3*e)})})),t}(1),ye=g()((function(e,t){k.get("/api/search?q=".concat(e)).then((function(e){var r=e.ok,n=e.terms,a=e.error;if(!r)return 401===a.status_code?(localStorage.clear(),void window.history.replaceState({expired:!0},null,"/login")):[];t(n.map((function(e){return{value:e.id,label:e.word}})))}))}),1e3,{leading:!1,trailing:!0}),Ne=function(){var e=Object(a.useContext)(b),t=Object(l.g)(),r=Object(l.i)().collectionId,s=void 0===r?null:r,o=Object(a.useState)({busy:!1,error:null}),u=Object(n.a)(o,2),i=u[0],d=u[1],f=Object(a.useState)({}),g=Object(n.a)(f,2),h=g[0],x=g[1],v=Object(a.useState)(""),E=Object(n.a)(v,2),N=E[0],I=E[1],S=Object(a.useState)(10),_=Object(n.a)(S,2),A=_[0],P=_[1],R=Object(a.useCallback)((function(){t.replace("/collections")}),[t]),T=Object(a.useCallback)(function(){var e=Object(p.a)(m.a.mark((function e(r){var n,a,c,o,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.target.value,x(Object(C.a)({},h,{name:n})),!(a=je.patch("/api/me/collections/".concat(s),{name:n}))){e.next=14;break}return e.next=6,a;case 6:if(c=e.sent,o=c.ok,u=c.error,o){e.next=14;break}if(401!==u.status_code){e.next=14;break}return localStorage.clear(),t.replace("/login",{expired:!0}),e.abrupt("return");case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[h]),L=Object(a.useCallback)(function(){var r=Object(p.a)(m.a.mark((function r(n,a){var c,o,u,l;return m.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("select-option"===a.action){r.next=3;break}return r.abrupt("return");case 3:return e({type:c="user/add-to-collections",status:"pending"}),r.next=7,k.post("/api/me/collections/".concat(s,"/terms"),{term_id:n.value});case 7:if(o=r.sent,u=o.ok,l=o.error,u){r.next=16;break}if(401!==l.status_code){r.next=15;break}return localStorage.clear(),t.replace("/login",{expired:!0}),r.abrupt("return");case 15:return r.abrupt("return",e({type:c,status:"error",error:l}));case 16:x(Object(C.a)({},h,{terms:[{id:n.value,word:n.label}].concat(Object(Ee.a)(h.terms||[]))}));case 17:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}(),[h]),M=Object(a.useCallback)(function(){var e=Object(p.a)(m.a.mark((function e(r){var n,a,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.delete("/api/me/collections/".concat(s,"/terms/").concat(r));case 2:if(n=e.sent,a=n.ok,c=n.error,a){e.next=11;break}if(401!==c.status_code){e.next=10;break}return localStorage.clear(),t.replace("/login",{expired:!0}),e.abrupt("return");case 10:return e.abrupt("return");case 11:x(Object(C.a)({},h,{terms:h.terms.filter((function(e){return e.id!==r}))}),[h]);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[h]);return Object(a.useEffect)((function(){d({busy:!0}),Object(p.a)(m.a.mark((function e(){var r,n,a,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get("/api/me/collections/".concat(s));case 2:if(r=e.sent,n=r.ok,a=r.error,c=r.collection,n){e.next=12;break}if(401!==a.status_code){e.next=11;break}return localStorage.clear(),t.replace("/login",{expired:!0}),e.abrupt("return");case 11:return e.abrupt("return");case 12:d({busy:!1}),x(c);case 14:case"end":return e.stop()}}),e)})))()}),[s]),c.a.createElement(w.a,{isOpen:!0},c.a.createElement(Z.a,{toggle:R},"Edit Collection"),c.a.createElement(O.a,null,i.busy&&c.a.createElement("div",{className:"loader loader-dark"},"Loading..."),!i.busy&&c.a.createElement($.a,null,c.a.createElement(K.a,null,c.a.createElement(Q.a,null,"Name"),c.a.createElement(X.a,{value:h.name,onChange:T})),c.a.createElement(K.a,null,c.a.createElement(Oe.a,{placeholder:"Enter your new word...",value:N,onInputChange:function(e){return I(e)},onChange:L,loadOptions:ye}),c.a.createElement(ke.a,{flush:!0},(h.terms||[]).slice(0,A).map((function(e){return c.a.createElement(we.a,{key:e.id},e.word,c.a.createElement(y.a,{size:"sm",color:"link",className:"float-right",onClick:function(){return M(e.id)}},"\xd7"))})),h.terms&&A<h.terms.length&&c.a.createElement(we.a,null,c.a.createElement(y.a,{color:"link",block:!0,onClick:function(){return P(2*A)}},"Show more >>")))))),c.a.createElement(j.a,null,c.a.createElement(y.a,{onClick:R,color:"light"},"Close")))};var Ce=function(){Object(a.useContext)(b);var e=Object(a.useContext)(d);return c.a.createElement("div",{className:"App"},c.a.createElement(u.a,null,c.a.createElement(l.d,null,c.a.createElement(l.b,{exact:!0,path:"/login"},c.a.createElement(V,null)),c.a.createElement(l.b,{exact:!0,path:"/play/:sessionId"},c.a.createElement(ve,null),c.a.createElement(z,null)),c.a.createElement(l.b,{exact:!0,path:"/play"},c.a.createElement(ve,null),c.a.createElement(z,null)),c.a.createElement(l.b,{exact:!0,path:"/report"},c.a.createElement(ve,null),c.a.createElement(fe,null)),c.a.createElement(l.b,{path:"/collections",render:function(){return e.getIn(["profile","isLoggedIn"])?c.a.createElement(c.a.Fragment,null,c.a.createElement(ve,null),c.a.createElement(ce,null),c.a.createElement(l.b,{path:"/collections/:collectionId"},c.a.createElement(Ne,null))):c.a.createElement(l.a,{to:"/login"})}}),c.a.createElement(l.b,null,c.a.createElement(l.a,{to:"/login"})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ie=r(14),Se=r(20),_e=Object(Se.a)({profile:{isLoggedIn:!1},gameSession:{id:null,status:"pending"},collections:[],report:{}}),Ae=function(e,t){var r=t.type,n=t.status,a=Object(Ie.a)(t,["type","status"]);if("error"===n)return a.error&&"Invalid token"===a.error?e.set("profile",Object(Se.a)({isLoggedIn:!1})):e;if("pending"===n)return e;switch(console.log({type:r,action:a,state:e.toJS()}),r){case"user/login":return e.set("profile",Object(Se.a)(Object(C.a)({isLoggedIn:!0,defaultCollection:a.defaultCollection},a.profile)));case"user/logout":return e.set("profile",Object(Se.a)({isLoggedIn:!1}));case"user/list-collections":return e.set("collections",Object(Se.a)(a.collections)).set("myCollections",Object(Se.a)(a.myCollections));case"user/create-collection":return e.updateIn(["myCollections"],(function(e){return e.unshift(Object(Se.a)(a.collection))}));case"user/start-session":return e.setIn(["gameSession"],Object(Se.a)(Object(C.a)({},a.session,{hasNext:!0,status:"playing"})));case"user/next-term":return e.setIn(["gameSession","term"],Object(Se.a)(a.term)).setIn(["gameSession","cursor"],a.cursor).setIn(["gameSession","hasNext"],a.hasNext);case"user/show-report":return e.setIn(["gameSession","status"],"done").set("report",Object(Se.a)(a.report));default:return e}},Pe=function(e){var t=Object(a.useReducer)(Ae,_e),r=Object(n.a)(t,2),s=r[0],o=r[1];return c.a.createElement(b.Provider,{value:o},c.a.createElement(d.Provider,{value:s},c.a.createElement(Ce,null)))};_().then((function(){o.a.render(c.a.createElement(Pe,null),document.getElementById("root"))})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},83:function(e,t,r){e.exports=r(196)},89:function(e,t,r){},90:function(e,t,r){}},[[83,1,2]]]);
//# sourceMappingURL=main.9d6e7dbe.chunk.js.map